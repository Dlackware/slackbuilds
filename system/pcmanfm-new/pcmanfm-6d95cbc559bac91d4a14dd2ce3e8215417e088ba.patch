From 6d95cbc559bac91d4a14dd2ce3e8215417e088ba Mon Sep 17 00:00:00 2001
From: Hong Jen Yee (PCMan) <pcman.tw@gmail.com>
Date: Sat, 27 Nov 2010 13:21:36 +0800
Subject: [PATCH] Fix #3112447 - Daemon mode opens window.

---
 src/pcmanfm.c |   17 ++++++++++-------
 1 files changed, 10 insertions(+), 7 deletions(-)

diff --git a/src/pcmanfm.c b/src/pcmanfm.c
index 989e471..114a8a1 100644
--- a/src/pcmanfm.c
+++ b/src/pcmanfm.c
@@ -368,13 +368,16 @@ gboolean pcmanfm_run()
         }
         else
         {
-            FmPath* path;
-            char* cwd = ipc_cwd ? ipc_cwd : g_get_current_dir();
-            path = fm_path_new_for_path(cwd);
-            fm_main_win_add_win(NULL, path);
-            fm_path_unref(path);
-            g_free(cwd);
-            ipc_cwd = NULL;
+			if(!daemon_mode)
+			{
+				FmPath* path;
+				char* cwd = ipc_cwd ? ipc_cwd : g_get_current_dir();
+				path = fm_path_new_for_path(cwd);
+				fm_main_win_add_win(NULL, path);
+				fm_path_unref(path);
+				g_free(cwd);
+				ipc_cwd = NULL;
+			}
         }
     }
     return ret;
-- 
1.7.0.1

